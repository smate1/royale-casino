<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Профиль - Casino Royale</title>
  <script>
    (function () {
      const theme = localStorage.getItem('theme') || 'dark'
      document.documentElement.classList.add(theme === 'light' ? 'light-theme' : 'dark-theme')
    })()
  </script>
  <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
  <meta name="description"
    content="Профиль пользователя в Casino Royale - управляйте своим аккаунтом и следите за статистикой." />
  <link rel="stylesheet" href="./assets/index-G69gVI9e.css" />
  <link rel="stylesheet" href="./styles/decorations.css" />
  <link rel="stylesheet" href="./styles/burger-menu.css" />
  <link rel="stylesheet" href="./styles/main.css" />
  <link rel="stylesheet" href="./styles/theme-toggle.css" />
</head>

<body>
  <div id="app">
    <!-- Анимированные пузырьки на фоне -->
    <div class="bubbles-container">
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
    </div>
    <div class="burger-menu-btn">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <nav class="main-nav main-nav-mobile">
      <button id="theme-toggle" class="theme-toggle-btn" title="Переключить тему">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
      </button>
      <ul class="nav-list">
        <li><a href="./index.html" class="nav-link">Главная</a></li>
        <li><a href="./jackpot.html" class="nav-link">Джекпот</a></li>
        <li><a href="./x50.html" class="nav-link">X50</a></li>
        <li><a href="./dice.html" class="nav-link">Dice</a></li>
        <li><a href="./mines.html" class="nav-link">Мины</a></li>
        <li><a href="./bonus.html" class="nav-link">Бонусы</a></li>
        <li><a href="./referral.html" class="nav-link">Рефералы</a></li>
      </ul>
    </nav>
    <div class="menu-overlay"></div>
    <div class="page-wrapper">
      <header class="header">
        <div class="container header-container">
          <div class="header__top">
            <a href="./index.html" class="logo">
              <span class="logo-text">Casino Royale</span>
            </a>

          </div>
          <nav class="main-nav">
            <button id="theme-toggle" class="theme-toggle-btn" title="Переключить тему">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
            </button>
            <ul class="nav-list">
              <li><a href="./index.html" class="nav-link">Главная</a></li>
              <li><a href="./jackpot.html" class="nav-link">Джекпот</a></li>
              <li><a href="./x50.html" class="nav-link">X50</a></li>
              <li><a href="./dice.html" class="nav-link">Dice</a></li>
              <li><a href="./mines.html" class="nav-link">Мины</a></li>
              <li><a href="./bonus.html" class="nav-link">Бонусы</a></li>
              <li><a href="./referral.html" class="nav-link">Рефералы</a></li>
            </ul>
          </nav>
          <div class="auth-container">
            <button id="login-vk" class="auth-btn vk">Войти через VK</button>
            <button id="login-tg" class="auth-btn tg">Войти через TG</button>
          </div>
        </div>
      </header>
      <main class="main-content">
        <div class="container">
          <div class="profile-container">
            <div class="profile-header">
              <div class="corner-decoration top-left"></div>
              <div class="corner-decoration top-right"></div>
              <div class="corner-decoration bottom-left"></div>
              <div class="corner-decoration bottom-right"></div>
              <div class="profile-avatar">
                <img src="./images/profile.svg" alt="Аватар пользователя" class="avatar-img" id="profile-avatar-img" />
              </div>
              <div class="profile-info">
                <h1 class="profile-username" id="profile-username">Загрузка...</h1>
                <div class="profile-badges">
                  <span class="badge rank-badge" id="profile-rank">[BRONZE]</span>
                  <span class="badge join-date" id="profile-join-date">Дата регистрации: 01.01.2023</span>
                </div>
              </div>
            </div>

            <div class="profile-stats">
              <div class="stats-card">
                <div class="corner-decoration top-left"></div>
                <div class="corner-decoration top-right"></div>
                <div class="corner-decoration bottom-left"></div>
                <div class="corner-decoration bottom-right"></div>
                <h2 class="section-title">Баланс</h2>
                <div class="balance-info">
                  <div class="balance-item">
                    <span class="balance-label">Доступно:</span>
                    <span class="balance-value" id="profile-balance">₽0.00</span>
                  </div>
                  <div class="balance-buttons" id="balance-buttons">
                    <button class="action-btn deposit-btn">Пополнить</button>
                    <button class="action-btn withdraw-btn">Вывести</button>
                  </div>
                </div>
              </div>

              <div class="stats-card">
                <div class="corner-decoration top-left"></div>
                <div class="corner-decoration top-right"></div>
                <div class="corner-decoration bottom-left"></div>
                <div class="corner-decoration bottom-right"></div>
                <h2 class="section-title">Статистика</h2>
                <div class="stats-grid">
                  <div class="stat-item">
                    <span class="stat-value" id="total-deposits">₽0</span>
                    <span class="stat-label">Всего депозитов</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-value" id="total-withdrawals">₽0</span>
                    <span class="stat-label">Всего выводов</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-value" id="total-won">₽0</span>
                    <span class="stat-label">Всего выиграно</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-value" id="total-lost">₽0</span>
                    <span class="stat-label">Всего проиграно</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="profile-tabs" id="profile-tabs">
              <div class="tabs-header">
                <button class="tab-btn active" data-tab="history">История игр</button>
                <button class="tab-btn" data-tab="transactions">История транзакций</button>
                <button class="tab-btn" data-tab="settings" id="settings-tab-btn">Настройки</button>
              </div>

              <div class="tab-content active" id="history-tab">
                <div class="corner-decoration top-left"></div>
                <div class="corner-decoration top-right"></div>
                <div class="corner-decoration bottom-left"></div>
                <div class="corner-decoration bottom-right"></div>
                <h2 class="section-title">История игр</h2>
                <div class="table-container">
                  <table class="history-table">
                    <thead>
                      <tr>
                        <th>Дата</th>
                        <th>Игра</th>
                        <th>Ставка</th>
                        <th>Результат</th>
                        <th>Выигрыш</th>
                      </tr>
                    </thead>
                    <tbody id="games-history-tbody">
                      <!-- Данные будут добавлены динамически -->
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="tab-content" id="transactions-tab">
                <div class="corner-decoration top-left"></div>
                <div class="corner-decoration top-right"></div>
                <div class="corner-decoration bottom-left"></div>
                <div class="corner-decoration bottom-right"></div>
                <h2 class="section-title">История транзакций</h2>
                <div class="table-container">
                  <table class="transactions-table">
                    <thead>
                      <tr>
                        <th>Дата</th>
                        <th>Тип</th>
                        <th>Сумма</th>
                        <th>Статус</th>
                      </tr>
                    </thead>
                    <tbody id="transactions-history-tbody">
                      <!-- Данные будут добавлены динамически -->
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="tab-content" id="settings-tab">
                <div class="corner-decoration top-left"></div>
                <div class="corner-decoration top-right"></div>
                <div class="corner-decoration bottom-left"></div>
                <div class="corner-decoration bottom-right"></div>
                <h2 class="section-title">Настройки профиля</h2>
                <form class="settings-form">
                  <div class="form-group">
                    <label for="username">Имя пользователя:</label>
                    <input type="text" id="username" class="control-input" value="Имя пользователя" disabled>
                    <p class="form-note">Имя пользователя нельзя изменить</p>
                  </div>
                  <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" class="control-input" value="user@example.com">
                  </div>
                  <div class="form-group">
                    <label for="avatar">Аватар:</label>
                    <div class="avatar-upload">
                      <div class="current-avatar">
                        <img src="./images/profile.svg" alt="Аватар" class="avatar-preview">
                      </div>
                      <input type="file" id="avatar" class="avatar-input">
                      <button type="button" class="secondary-btn">Выбрать файл</button>
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Двухфакторная аутентификация:</label>
                    <div class="toggle-switch">
                      <input type="checkbox" id="2fa-toggle" class="toggle-input">
                      <label for="2fa-toggle" class="toggle-label"></label>
                      <span class="toggle-status">Выключено</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <button type="submit" class="action-btn">Сохранить изменения</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </main>
      <footer class="footer">
        <div class="container">
          <div class="footer-content">
            <div class="footer-logo">
              <span class="logo-text">Casino Royale</span>
              <p class="copyright">© 2022-2025 Casino Royale</p>
            </div>
            <div class="footer-links">
              <ul class="footer-nav">
                <li><a href="./faq.html">FAQ</a></li>
                <li><a href="./support.html">Поддержка</a></li>
                <li><a href="./terms.html">Условия использования</a></li>
              </ul>
            </div>
            <div class="footer-social">
              <a href="#" class="social-link vk">VK</a>
              <a href="#" class="social-link tg">TG</a>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Модальные окна -->
    <div class="modal" id="auth-modal">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Авторизация</h2>
        <div class="auth-methods">
          <button class="auth-method vk">Войти через VK</button>
          <button class="auth-method tg">Войти через TG</button>
        </div>
      </div>
    </div>
  </div>
  <script src="./assets/burger-menu.js" defer></script>
  <script src="./assets/range-inputs.js" defer></script>
  <script src="./assets/particles.js" defer></script>
  <script src="./assets/global-chat.js" defer></script>
  <script src="./assets/theme-switcher.js" defer></script>
  <script type="module" crossorigin src="./assets/index-ChTbzDwl.js"></script>
  <script>
    // Скрипт для работы с вкладками профиля и получения данных пользователя
    document.addEventListener('DOMContentLoaded', function () {
      // Получаем параметры из URL
      const urlParams = new URLSearchParams(window.location.search);
      const userParam = urlParams.get('user');

      // Константы для рангов
      const RANKS = {
        'bronze': { min: 5000, name: 'BRONZE', class: 'bronze' },
        'silver': { min: 10000, name: 'SILVER', class: 'silver' },
        'platinum': { min: 20000, name: 'PLATINUM', class: 'platinum' },
        'gold': { min: 50000, name: 'GOLD', class: 'gold' },
        'sapphire': { min: 100000, name: 'SAPPHIRE', class: 'sapphire' },
        'diamond': { min: 250000, name: 'DIAMOND', class: 'diamond' },
        'legend': { min: 500000, name: 'LEGEND', class: 'legend' }
      };

      // Определяем, свой профиль или чужой
      const isOwnProfile = !userParam;
      const username = userParam || 'Мой профиль';

      // Обновляем элементы страницы
      document.getElementById('profile-username').textContent = username;
      document.title = `${username} - Профиль | Casino Royale`;

      // Генерируем случайные данные для демонстрации
      function getRandomAmount(min, max) {
        return Math.floor(Math.random() * (max - min + 1) + min);
      }

      function getRandomDate(start, end) {
        return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
      }

      // Форматирование суммы
      function formatAmount(amount) {
        return '₽' + amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
      }

      // Форматирование даты
      function formatDate(date) {
        return `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}.${date.getFullYear()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
      }

      // Вычисляем ранг в зависимости от суммы депозитов
      function calculateRank(totalDeposits) {
        let userRank = RANKS.bronze;

        for (const key in RANKS) {
          if (totalDeposits >= RANKS[key].min) {
            userRank = RANKS[key];
          }
        }

        return userRank;
      }

      // Генерируем/получаем данные пользователя
      function generateUserData() {
        // Для демонстрации генерируем случайные данные
        const totalDeposits = getRandomAmount(1000, 300000);
        const totalWithdrawals = getRandomAmount(0, totalDeposits * 0.8);
        const totalWon = getRandomAmount(totalDeposits * 0.5, totalDeposits * 2);
        const totalLost = getRandomAmount(totalDeposits * 0.3, totalDeposits * 1.5);
        const balance = totalDeposits - totalWithdrawals + totalWon - totalLost;

        // Вычисляем ранг пользователя
        const userRank = calculateRank(totalDeposits);

        // Генерируем дату регистрации
        const endDate = new Date();
        const startDate = new Date(2022, 0, 1);
        const joinDate = getRandomDate(startDate, endDate);

        return {
          username: username,
          balance: balance,
          totalDeposits: totalDeposits,
          totalWithdrawals: totalWithdrawals,
          totalWon: totalWon,
          totalLost: totalLost,
          rank: userRank,
          joinDate: joinDate
        };
      }

      // Заполняем историю игр
      function populateGamesHistory(count = 10) {
        const gamesHistoryTbody = document.getElementById('games-history-tbody');
        const games = ['Dice', 'X50', 'Джекпот', 'Мины'];
        const endDate = new Date();
        const startDate = new Date(endDate.getTime() - 30 * 24 * 60 * 60 * 1000); // 30 дней назад

        let html = '';

        for (let i = 0; i < count; i++) {
          const game = games[Math.floor(Math.random() * games.length)];
          const bet = getRandomAmount(100, 2000);
          const isWin = Math.random() > 0.5;
          const multiplier = isWin ? Math.random() * 3 + 1 : 0;
          const result = isWin ? 'Выигрыш' : 'Проигрыш';
          const winAmount = isWin ? Math.floor(bet * multiplier) : -bet;
          const gameDate = getRandomDate(startDate, endDate);

          html += `
            <tr>
              <td>${formatDate(gameDate)}</td>
              <td>${game}</td>
              <td>₽${bet}</td>
              <td>${result}</td>
              <td class="${isWin ? 'win' : 'loss'}">${isWin ? '+' : ''}₽${Math.abs(winAmount)}</td>
            </tr>
          `;
        }

        gamesHistoryTbody.innerHTML = html;
      }

      // Заполняем историю транзакций
      function populateTransactionsHistory(count = 10) {
        const transactionsHistoryTbody = document.getElementById('transactions-history-tbody');
        const types = ['Пополнение', 'Вывод'];
        const endDate = new Date();
        const startDate = new Date(endDate.getTime() - 30 * 24 * 60 * 60 * 1000); // 30 дней назад

        let html = '';

        for (let i = 0; i < count; i++) {
          const isDeposit = Math.random() > 0.3; // больше депозитов, чем выводов
          const type = isDeposit ? types[0] : types[1];
          const amount = getRandomAmount(1000, 10000);
          const status = Math.random() > 0.1 ? 'Успешно' : 'В обработке';
          const transactionDate = getRandomDate(startDate, endDate);

          html += `
            <tr>
              <td>${formatDate(transactionDate)}</td>
              <td>${type}</td>
              <td class="${isDeposit ? 'deposit' : 'withdraw'}">${isDeposit ? '+' : '-'}₽${amount}</td>
              <td><span class="status-badge ${status === 'Успешно' ? 'success' : 'pending'}">${status}</span></td>
            </tr>
          `;
        }

        transactionsHistoryTbody.innerHTML = html;
      }

      // Загружаем и отображаем данные пользователя
      function loadUserProfile() {
        const userData = generateUserData();

        // Обновляем информацию профиля
        document.getElementById('profile-username').textContent = userData.username;
        document.getElementById('profile-rank').textContent = `[${userData.rank.name}]`;
        document.getElementById('profile-rank').className = `badge rank-badge ${userData.rank.class}`;
        document.getElementById('profile-join-date').textContent = `Дата регистрации: ${formatDate(userData.joinDate).split(' ')[0]}`;
        document.getElementById('profile-balance').textContent = formatAmount(userData.balance);
        document.getElementById('total-deposits').textContent = formatAmount(userData.totalDeposits);
        document.getElementById('total-withdrawals').textContent = formatAmount(userData.totalWithdrawals);
        document.getElementById('total-won').textContent = formatAmount(userData.totalWon);
        document.getElementById('total-lost').textContent = formatAmount(userData.totalLost);

        // Генерируем аватар на основе имени
        const colors = ['#FF6B00', '#FF9500', '#FFB700', '#4CAF50', '#2196F3', '#673AB7', '#E91E63'];
        const colorIndex = userData.username.length % colors.length;
        const avatarSvg = `
          <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100">
            <rect width="100" height="100" fill="${colors[colorIndex]}" />
            <text x="50" y="50" font-size="40" fill="white" text-anchor="middle" dominant-baseline="middle" font-family="Arial, sans-serif" font-weight="bold">
              ${userData.username.substring(0, 2).toUpperCase()}
            </text>
          </svg>
        `;

        // Используем безопасный метод кодирования в base64
        function utf8_to_b64(str) {
          return btoa(unescape(encodeURIComponent(str)));
        }
        const base64Svg = utf8_to_b64(avatarSvg);

        const avatarImg = document.getElementById('profile-avatar-img');
        avatarImg.src = `data:image/svg+xml;base64,${base64Svg}`;

        // Если это чужой профиль, скрываем кнопки управления балансом и вкладку настроек
        if (!isOwnProfile) {
          const balanceButtons = document.getElementById('balance-buttons');
          balanceButtons.style.display = 'none';

          const settingsTabBtn = document.getElementById('settings-tab-btn');
          settingsTabBtn.style.display = 'none';
        } else {
          // Заполняем поля формы для своего профиля
          document.getElementById('username').value = userData.username;
        }

        // Заполняем историю
        populateGamesHistory();
        populateTransactionsHistory();
      }

      // Загружаем профиль
      loadUserProfile();

      // Обработка вкладок
      const tabButtons = document.querySelectorAll('.tab-btn');
      const tabContents = document.querySelectorAll('.tab-content');

      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          // Убираем активный класс у всех кнопок и контентов
          tabButtons.forEach(btn => btn.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));

          // Добавляем активный класс к нажатой кнопке
          button.classList.add('active');

          // Показываем соответствующий контент
          const tabId = button.getAttribute('data-tab');
          document.getElementById(`${tabId}-tab`).classList.add('active');
        });
      });

      // Переключатель для двухфакторной аутентификации
      const twoFaToggle = document.getElementById('2fa-toggle');
      const toggleStatus = document.querySelector('.toggle-status');

      if (twoFaToggle) {
        twoFaToggle.addEventListener('change', function () {
          if (this.checked) {
            toggleStatus.textContent = 'Включено';
          } else {
            toggleStatus.textContent = 'Выключено';
          }
        });
      }
    });
  </script>
</body>

</html>
